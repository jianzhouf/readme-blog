<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>urls与视图详解 | 标 の 博客</title>
    <meta name="description" content="Django - urls与视图详解">
    <link rel="icon" href="/readme-blog/favicon.ico">
    <meta name="keywords" content="Django - urls与视图详解">
    <link rel="preload" href="/readme-blog/assets/css/0.styles.6ef3f410.css" as="style"><link rel="preload" href="/readme-blog/assets/js/app.9f4188c2.js" as="script"><link rel="preload" href="/readme-blog/assets/js/11.71e3a724.js" as="script"><link rel="preload" href="/readme-blog/assets/js/4.590cfbfe.js" as="script"><link rel="prefetch" href="/readme-blog/assets/js/10.8570bec5.js"><link rel="prefetch" href="/readme-blog/assets/js/12.d47b8787.js"><link rel="prefetch" href="/readme-blog/assets/js/13.9bbdf132.js"><link rel="prefetch" href="/readme-blog/assets/js/14.479e519e.js"><link rel="prefetch" href="/readme-blog/assets/js/15.19e06226.js"><link rel="prefetch" href="/readme-blog/assets/js/16.2698e0ff.js"><link rel="prefetch" href="/readme-blog/assets/js/17.62f3cb55.js"><link rel="prefetch" href="/readme-blog/assets/js/18.79aca22f.js"><link rel="prefetch" href="/readme-blog/assets/js/19.791bc677.js"><link rel="prefetch" href="/readme-blog/assets/js/2.a42a8e98.js"><link rel="prefetch" href="/readme-blog/assets/js/20.cb02846d.js"><link rel="prefetch" href="/readme-blog/assets/js/21.e8c3341c.js"><link rel="prefetch" href="/readme-blog/assets/js/22.2b0c6f59.js"><link rel="prefetch" href="/readme-blog/assets/js/23.77036d88.js"><link rel="prefetch" href="/readme-blog/assets/js/24.859cb6c3.js"><link rel="prefetch" href="/readme-blog/assets/js/25.6d0e9afb.js"><link rel="prefetch" href="/readme-blog/assets/js/26.a8efd2c0.js"><link rel="prefetch" href="/readme-blog/assets/js/27.711156f6.js"><link rel="prefetch" href="/readme-blog/assets/js/28.8bfd010b.js"><link rel="prefetch" href="/readme-blog/assets/js/29.ea156da5.js"><link rel="prefetch" href="/readme-blog/assets/js/3.8009bdf1.js"><link rel="prefetch" href="/readme-blog/assets/js/30.59a5cdf2.js"><link rel="prefetch" href="/readme-blog/assets/js/5.e9638192.js"><link rel="prefetch" href="/readme-blog/assets/js/6.15f05cde.js"><link rel="prefetch" href="/readme-blog/assets/js/7.dfc41969.js"><link rel="prefetch" href="/readme-blog/assets/js/8.3131c432.js"><link rel="prefetch" href="/readme-blog/assets/js/9.63a49ba8.js">
    <link rel="stylesheet" href="/readme-blog/assets/css/0.styles.6ef3f410.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/readme-blog/" class="home-link router-link-active"><!----> <span class="site-name">标 の 博客</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端栈</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/readme-blog/WEB/ES6/array.html" class="nav-link">ES6</a></li><li class="dropdown-item"><!----> <a href="/readme-blog/WEB/Vue/vuepress-blog.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/readme-blog/WEB/React/react-router.html" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/readme-blog/Python/Python/virtualenv-win.html" class="nav-link">Python杂谈</a></li><li class="dropdown-item"><!----> <a href="/readme-blog/Python/Django/urls.html" class="nav-link router-link-exact-active router-link-active">Django</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/readme-blog/Database/MySQL/mysql5.7_install.html" class="nav-link">MySQL</a></li></ul></div></div> <a href="https://github.com/zhb333/readme-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    代码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端栈</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/readme-blog/WEB/ES6/array.html" class="nav-link">ES6</a></li><li class="dropdown-item"><!----> <a href="/readme-blog/WEB/Vue/vuepress-blog.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/readme-blog/WEB/React/react-router.html" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Python</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/readme-blog/Python/Python/virtualenv-win.html" class="nav-link">Python杂谈</a></li><li class="dropdown-item"><!----> <a href="/readme-blog/Python/Django/urls.html" class="nav-link router-link-exact-active router-link-active">Django</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/readme-blog/Database/MySQL/mysql5.7_install.html" class="nav-link">MySQL</a></li></ul></div></div> <a href="https://github.com/zhb333/readme-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    代码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>Python杂谈</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Django</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/readme-blog/Python/Django/urls.html" class="active sidebar-link">urls与视图详解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#一、准备工作" class="sidebar-link">一、准备工作</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#二、项目结构分析" class="sidebar-link">二、项目结构分析</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#三、debug-模式-与-allowed-hosts" class="sidebar-link">三、DEBUG 模式  与 ALLOWED_HOSTS</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#四、root-urlconf-设置-urls-匹配的入口文件" class="sidebar-link">四、ROOT_URLCONF 设置 urls 匹配的入口文件</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#五、初识视图函数" class="sidebar-link">五、初识视图函数</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#六、urls-分层模块化" class="sidebar-link">六、urls 分层模块化</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#七、url中的参数传递" class="sidebar-link">七、url中的参数传递</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#八、-内置的-path-转换器" class="sidebar-link">八、 内置的 path 转换器</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#九、自定义-path-转换器" class="sidebar-link">九、自定义 path 转换器</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#十、重定向-与-url-命名反转" class="sidebar-link">十、重定向 与 url 命名反转</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#十一、-urls的-应用命名空间-与-实例命名空间" class="sidebar-link">十一、 urls的 应用命名空间 与 实例命名空间</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#十二、-re-path-函数" class="sidebar-link">十二、 re_path 函数</a></li><li class="sidebar-sub-header"><a href="/readme-blog/Python/Django/urls.html#十三、默认参数" class="sidebar-link">十三、默认参数</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="urls与视图详解"><a href="#urls与视图详解" aria-hidden="true" class="header-anchor">#</a> <code>urls</code>与视图详解</h1> <blockquote><p>环境 <code>Windows10</code></p></blockquote> <h2 id="一、准备工作"><a href="#一、准备工作" aria-hidden="true" class="header-anchor">#</a> 一、准备工作</h2> <ul><li><p>使用 <code>virtualenvwrapper</code> 创建并进入虚拟环境</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>mkvirtualenv myenv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>安装 <code>Django2.0</code></p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>pip install django==2.0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>查看是否安装成功</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>pip list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>创建一个名为 <code>mysite</code> 的 <code>django</code> 项目</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>django-admin startproject mysite
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>进入虚拟环境所在目录</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>cdvirtualenv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>打开当前目录</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>start %cd%
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>将 <code>mysite</code> 目录拖到 <code>pycharm</code> 打开</p></li> <li><p>设置 <code>pycharm</code> 的 <code>python</code> 环境  具体设置： <a href="https://zhb333.github.io/readme-blog/Python/Python/virtualenv-win.html#pycharm-%E4%B8%8E-virtualenvwrapper-%E7%9A%84%E9%85%8D%E5%90%88" title="pycharm配置python环境" target="_blank" rel="noopener noreferrer">点击查看<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h2 id="二、项目结构分析"><a href="#二、项目结构分析" aria-hidden="true" class="header-anchor">#</a> 二、项目结构分析</h2> <ul><li><p><code>manange.py</code> 项目的管理与交互都基于这个文件， 如启动项目：</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>python manange.py runserver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>__init__.py</code> 表示这是一个 <code>python</code> 模块</p></li> <li><p><code>setting.py</code> 保存项目的所有配置信息</p></li> <li><p><code>urls.py</code> 编写路由与视图的映射规则</p></li> <li><p><code>wsig.py</code> 项目部署文件</p></li></ul> <h2 id="三、debug-模式-与-allowed-hosts"><a href="#三、debug-模式-与-allowed-hosts" aria-hidden="true" class="header-anchor">#</a> 三、<code>DEBUG</code> 模式  与 <code>ALLOWED_HOSTS</code></h2> <ul><li><p>在 <code>mysite/settings.py</code> 中 默认是开启了 <code>DEBUG</code> 模式的</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>DEBUG <span class="token operator">=</span> <span class="token boolean">True</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>DEBUG</code> 模式的作用</p> <ul><li>修改后自动重启项目</li> <li>详细的报错详细</li></ul></li> <li><p>关闭了 <code>DEBUG</code> 模式，必须设置 <code>ALLOWED_HOSTS</code>, 否则项目起不来</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>ALLOWED_HOSTS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token string">'192.168.0.108'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p><code>DEBUG</code> 模式, 默认是以 <code>IP</code> <code>0.0.0.0</code> 启动服务的， 但只要设置了 <code>ALLOWED_HOSTS</code>， 就只能通过<code>ALLOWED_HOSTS</code> 中的 <code>IP</code> 或 域名进行访问</p></li> <li><p>开发阶段，开启 <code>DEBUG</code>, 线上环境必须关闭 <code>DEBUG</code> 模式</p></li></ul> <h2 id="四、root-urlconf-设置-urls-匹配的入口文件"><a href="#四、root-urlconf-设置-urls-匹配的入口文件" aria-hidden="true" class="header-anchor">#</a> 四、<code>ROOT_URLCONF</code> 设置 <code>urls</code> 匹配的入口文件</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code>ROOT_URLCONF <span class="token operator">=</span> <span class="token string">'mysite.urls'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="五、初识视图函数"><a href="#五、初识视图函数" aria-hidden="true" class="header-anchor">#</a> 五、初识视图函数</h2> <ul><li>视图函数的第一个参数永远是 <code>HttpRequest</code> 对象</li> <li>视图函数只能返回 <code>HttpResponseBase</code>的子类对象<div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse


<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'cms首页'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul> <h2 id="六、urls-分层模块化"><a href="#六、urls-分层模块化" aria-hidden="true" class="header-anchor">#</a> 六、<code>urls</code> 分层模块化</h2> <ul><li><p>每个独立的模块对应 <code>Django</code> 的一个 <code>app</code></p></li> <li><p>创建两个 <code>app</code> : <code>front</code> 和 <code>cms</code></p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code># 创建前台模块
python manange.py startapp front

# 创建后台cms模块
python manange.py startapp cms
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>编写 <code>front/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># from django.shortcuts import render</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse

<span class="token comment"># Create your views here.</span>


<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'前台首页'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>编写 <code>cms/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># from django.shortcuts import render</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse

<span class="token comment"># Create your views here.</span>


<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'cms首页'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>创建 <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

app_name <span class="token operator">=</span> <span class="token string">'front'</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>创建 <code>cms/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

app_name <span class="token operator">=</span> <span class="token string">'cms'</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>编写 <code>mysite/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin
<span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> include

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">'admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'front.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'cms/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>启动项目</p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>python manange.py runserver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>访问 <code>front</code> 应用： <code>http://127.0.0.1:8000</code></p></li> <li><p>访问 <code>cms</code> 应用： <code>http://127.0.0.1:8000/cms/</code></p></li></ul> <h2 id="七、url中的参数传递"><a href="#七、url中的参数传递" aria-hidden="true" class="header-anchor">#</a> 七、<code>url</code>中的参数传递</h2> <ul><li><p>通过 <code>path</code> 传递</p> <ul><li><p>编写视图函数 <code>front/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">detail</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> article_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'当前文章id: %s'</span> <span class="token operator">%</span> article_id<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>编写urls <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>path<span class="token punctuation">(</span><span class="token string">'detail/&lt;article_id&gt;'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>detail<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'detail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>访问方式： <code>http://localhost:8000/detail/1</code></p></li></ul></li> <li><p>通过 查询字符串 传递</p> <ul><li><p>编写视图函数 <code>front/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">article_list</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
  author <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'author'</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'%s 相关的文章'</span> <span class="token operator">%</span> author<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>编写urls <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>path<span class="token punctuation">(</span><span class="token string">'list/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>article_list<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>访问方式： <code>http://localhost:8000/list/?author=%E6%9D%8E%E7%99%BD</code></p></li></ul></li></ul> <h2 id="八、-内置的-path-转换器"><a href="#八、-内置的-path-转换器" aria-hidden="true" class="header-anchor">#</a> 八、 内置的 <code>path</code> 转换器</h2> <ul><li><p><code>int</code> 类型：</p> <ul><li><p>实现原理如下</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">IntConverter</span><span class="token punctuation">:</span>
  regex <span class="token operator">=</span> <span class="token string">'[0-9]+'</span>

  <span class="token keyword">def</span> <span class="token function">to_python</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>

  <span class="token keyword">def</span> <span class="token function">to_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
      <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>改写 <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>path<span class="token punctuation">(</span><span class="token string">'detail/&lt;int:article_id&gt;'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>detail<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'detail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>改写  <code>front/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">detail</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> article_id<span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>article_id<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'当前文章id: %s'</span> <span class="token operator">%</span> article_id<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>访问： <strong>http://localhost:8000/detail/1</strong></p></li> <li><p>控制台输出 <code>&lt;class 'int'&gt;</code></p></li></ul></li> <li><p><code>str</code> 类型， 默认不指定类型，就是 <code>str</code> 类型</p> <ul><li>原理：<div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">StringConverter</span><span class="token punctuation">:</span>
regex <span class="token operator">=</span> <span class="token string">'[^/]+'</span>

<span class="token keyword">def</span> <span class="token function">to_python</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> value

<span class="token keyword">def</span> <span class="token function">to_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> value

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul></li> <li><p><code>uuid</code> 类型，通用唯一识别码</p> <ul><li><p>原理：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">UUIDConverter</span><span class="token punctuation">:</span>
regex <span class="token operator">=</span> <span class="token string">'[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}'</span>

<span class="token keyword">def</span> <span class="token function">to_python</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> uuid<span class="token punctuation">.</span>UUID<span class="token punctuation">(</span>value<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">to_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>生成一个<code>uuid</code> 如： <code>b8f12562-7006-4e21-9aeb-c3426d9dcbd3</code></p> <div class="language-shell line-numbers-mode"><pre class="language-text"><code>python

import uuid

uuid.uuid4()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>改写 <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>path<span class="token punctuation">(</span><span class="token string">'detail/&lt;uuid:article_id&gt;'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>detail<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'detail'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>访问： <code>http://localhost:8000/detail/b8f12562-7006-4e21-9aeb-c3426d9dcbd3</code></p></li></ul></li> <li><p><code>slug</code> 类型</p> <ul><li>原理：<div class="language-python line-numbers-mode"><pre class="language-python"><code>  regex <span class="token operator">=</span> <span class="token string">'[-a-zA-Z0-9_]+'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p><code>path</code> 类型</p> <ul><li>原理：<div class="language-python line-numbers-mode"><pre class="language-python"><code>  regex <span class="token operator">=</span> <span class="token string">'.+'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li></ul> <h2 id="九、自定义-path-转换器"><a href="#九、自定义-path-转换器" aria-hidden="true" class="header-anchor">#</a> 九、自定义 <code>path</code> 转换器</h2> <p><strong>这里，我们实现一个规则为： python+django+flask 的 <code>url</code> 参数， <code>python</code> 代码接收到的是通过 <code>+</code> 拆分后的列表, 转换器接收的参数也必须是一个列表； 比较抽象，还是看代码吧！</strong></p> <ul><li><p>创建 <code>front/converters.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> register_converter


<span class="token keyword">class</span> <span class="token class-name">CateConverter</span><span class="token punctuation">:</span>
    regex <span class="token operator">=</span> r<span class="token string">'\w+|(\w+\+\w+)+'</span>

    <span class="token keyword">def</span> <span class="token function">to_python</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> value<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'+'</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">to_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'+'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>value<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> RuntimeError<span class="token punctuation">(</span><span class="token string">'分类参数必须为 list 类型'</span><span class="token punctuation">)</span>


<span class="token comment"># 注册 path 转换器</span>
register_converter<span class="token punctuation">(</span>CateConverter<span class="token punctuation">,</span> <span class="token string">'cate'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p>修改 <code>front/__init__.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>  <span class="token comment"># 运行我们自定义的转换器</span>
  <span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> converters
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>修改 <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>  path<span class="token punctuation">(</span><span class="token string">'category/&lt;cate:category&gt;/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index_category<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'category'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改 <code>front/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">index_category</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> category<span class="token punctuation">)</span><span class="token punctuation">:</span>
  pathname <span class="token operator">=</span> reverse<span class="token punctuation">(</span><span class="token string">'front:category'</span><span class="token punctuation">,</span> kwargs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'category'</span><span class="token punctuation">:</span> category<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'分类列表为： %s, url 的 pathname 部分为： %s'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>category<span class="token punctuation">,</span> pathname<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>访问： <code>http://localhost:8000/category/python+django/</code>, 浏览器显示如下：</p> <p><code>分类列表为： ['python', 'django'], url 的 pathname 部分为： /category/python+django/</code></p></li></ul> <h2 id="十、重定向-与-url-命名反转"><a href="#十、重定向-与-url-命名反转" aria-hidden="true" class="header-anchor">#</a> 十、重定向 与 <code>url</code> 命名反转</h2> <blockquote><p>通过模拟 <code>cms</code> 后台登录进行讲解</p></blockquote> <ul><li><p>修改 <code>cms/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>  path<span class="token punctuation">(</span><span class="token string">'login/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>login<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改 <code>cms/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># from django.shortcuts import render</span>
<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse
<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> redirect<span class="token punctuation">,</span> reverse

<span class="token comment"># Create your views here.</span>


<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    username <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> username<span class="token punctuation">:</span>
        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'cms首页'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># 重定向登录页面</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>reverse<span class="token punctuation">(</span><span class="token string">'cms:login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># url 命名反转</span>


<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'登录页面'</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li> <li><p>访问： <code>http://localhost:8000/cms/</code> 会自动跳转到登录页面</p></li> <li><p>访问： <code>http://localhost:8000/cms/?username=zhb33</code> 才能访问 <code>cms</code> 后台首页</p></li> <li><p><code>url</code> 命名反转时的参数传递</p> <blockquote><p>如果反转时，<code>url</code> 需要接收参数， 可通过关键字参数传递， 如果传递的查询字符串， 需要手动进行拼接</p></blockquote> <ul><li>修改 <code>cms/urls.py</code></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>path<span class="token punctuation">(</span><span class="token string">'login/&lt;location&gt;'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>login<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>修改 <code>cms/views.py</code></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
  username <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> username<span class="token punctuation">:</span>
      <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'cms首页'</span><span class="token punctuation">)</span>
  <span class="token keyword">else</span><span class="token punctuation">:</span>
      <span class="token comment"># 重定向登录页面</span>
      login_url <span class="token operator">=</span> reverse<span class="token punctuation">(</span><span class="token string">'cms:login'</span><span class="token punctuation">,</span> kwargs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'location'</span><span class="token punctuation">:</span> <span class="token string">'深圳'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># url传参</span>
      login_url <span class="token operator">+=</span> <span class="token string">'?next=/'</span>  <span class="token comment"># 查询字符串</span>
      <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>login_url<span class="token punctuation">)</span>  <span class="token comment"># url 命名反转</span>


<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> location<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'登录页面, 登录地点是 %s'</span> <span class="token operator">%</span> location<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li><code>http://localhost:8000/cms/</code> 跳转到 <code>http://localhost:8000/cms/login/深圳?next=/</code></li></ul></li></ul> <h2 id="十一、-urls的-应用命名空间-与-实例命名空间"><a href="#十一、-urls的-应用命名空间-与-实例命名空间" aria-hidden="true" class="header-anchor">#</a> 十一、 <code>urls</code>的 应用命名空间 与 实例命名空间</h2> <ul><li><p>应用命名空间</p> <ul><li><p>可以在每个应用的 <code>urls.py</code> 通过 <code>app_name</code> 进行设置 (一般使用这种方式设置)</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>app_name <span class="token operator">=</span> <span class="token string">'cms'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>也可以在 <code>ROOT_URLCONF</code> 指定的 <code>urls.py</code> 中使用 <code>include</code> 时进行设置(不常用)</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># mysite/urls.py</span>
path<span class="token punctuation">(</span><span class="token string">'cms/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">,</span> <span class="token string">'cms'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 引入 cms 模块的 urls.py 并设置应用命名空间 为 cms</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>作用： 如上面的 <code>url</code> 命名反转时 <code>reverse('cms:login')</code>, 可以防止与其它应用的 <code>url</code> 命名冲突</p></li></ul></li> <li><p>实例命名空间</p> <ul><li><p>在通过 <code>include</code> 引用时，进行设置</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 设置实例命名空间</span>
path<span class="token punctuation">(</span><span class="token string">'cms/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">'cms'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

<span class="token comment"># 同时设置 应用命名空间 和 实例命名空间</span>
path<span class="token punctuation">(</span><span class="token string">'cms/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">,</span> <span class="token string">'cms'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">'cms'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>作用： 当多个不同 <code>url</code> 指向同一个应用时， 防止 <code>url</code> 冲突</p> <p><strong>不使用实例命名空间的情况</strong></p> <ul><li><p>修改<code>mysite/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>path<span class="token punctuation">(</span><span class="token string">'cms1/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 不同的 url 指向同一个 应用</span>
path<span class="token punctuation">(</span><span class="token string">'cms2/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>访问 <code>http://localhost:8000/cms1/</code> 跳转到 <code>http://localhost:8000/cms1/login/深圳?next=/</code></p></li> <li><p>访问 <code>http://localhost:8000/cms2/</code> 也跳转到 <code>http://localhost:8000/cms1/login/深圳?next=/</code></p></li></ul> <p><strong>冲突了吧！</strong></p> <p><strong>使用实例命名空间</strong></p> <ul><li><p>修改<code>mysite/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>path<span class="token punctuation">(</span><span class="token string">'cms1/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">'cms1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
path<span class="token punctuation">(</span><span class="token string">'cms2/'</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'cms.urls'</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">'cms2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>修改<code>mysite/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
username <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> username<span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'cms首页'</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token comment"># 重定向登录页面</span>
    current_namespace <span class="token operator">=</span> request<span class="token punctuation">.</span>resolver_match<span class="token punctuation">.</span>namespace
    login_url <span class="token operator">=</span> reverse<span class="token punctuation">(</span><span class="token string">'%s:login'</span> <span class="token operator">%</span> current_namespace<span class="token punctuation">,</span> kwargs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">'location'</span><span class="token punctuation">:</span> <span class="token string">'深圳'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment"># url传参</span>
    login_url <span class="token operator">+=</span> <span class="token string">'?next=/'</span>  <span class="token comment"># 查询字符串</span>
    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>login_url<span class="token punctuation">)</span>  <span class="token comment"># url 命名反转</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>访问 <code>http://localhost:8000/cms1/</code> 跳转到 <code>http://localhost:8000/cms1/login/深圳?next=/</code></p></li> <li><p>访问 <code>http://localhost:8000/cms2/</code> 跳转到 <code>http://localhost:8000/cms2/login/深圳?next=/</code></p></li></ul></li></ul></li></ul> <h2 id="十二、-re-path-函数"><a href="#十二、-re-path-函数" aria-hidden="true" class="header-anchor">#</a> 十二、 <code>re_path</code> 函数</h2> <blockquote><p>通过正则进行匹配参数</p></blockquote> <p><strong>匹配生日</strong></p> <ul><li><p>修改 <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> re_path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

app_name <span class="token operator">=</span> <span class="token string">'front'</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token comment"># ?P&lt;birthday&gt; 表示参数为 birthday 匹配 \d{4}-\d{2}-\d{2}</span>
    re_path<span class="token punctuation">(</span>r<span class="token string">'^birthday/(?P&lt;birthday&gt;\d{4}-\d{2}-\d{2})/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index_birthday<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'birthday'</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>修改 <code>front/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">index_birthday</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> birthday<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'生日快乐 %s'</span> <span class="token operator">%</span> birthday<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>访问： <code>http://localhost:8000/birthday/1992-12-28/</code></p></li> <li><p>能用 <code>path</code> 解决的问题， 尽量不要用 <code>re_path</code> 因为 <code>re_path</code> 可读性差</p></li></ul> <h2 id="十三、默认参数"><a href="#十三、默认参数" aria-hidden="true" class="header-anchor">#</a> 十三、默认参数</h2> <p><strong>要实现默认参数，需要两条 <code>url</code> 的配合</strong></p> <ul><li><p>修改 <code>front/urls.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> re_path
<span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views

app_name <span class="token operator">=</span> <span class="token string">'front'</span>

urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>
    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index_list<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    path<span class="token punctuation">(</span><span class="token string">'list/&lt;int:category_id&gt;'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index_list<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>修改 <code>front/views.py</code></p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse


category <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'python'</span><span class="token punctuation">,</span> <span class="token string">'django'</span><span class="token punctuation">,</span> <span class="token string">'flask'</span><span class="token punctuation">]</span>


<span class="token keyword">def</span> <span class="token function">index_list</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> category_id<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>category<span class="token punctuation">[</span>category_id<span class="token punctuation">]</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>访问： <code>http://localhost:8000</code>, 显示:<br> <code>python</code></p></li> <li><p>访问： <code>http://localhost:8000/list/2</code>, 显示：<br> <code>flask</code></p></li></ul> <div id="vcomments"></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/zhb333/readme-blog/edit/master/Python/Django/urls.md" target="_blank" rel="noopener noreferrer">查看原文|编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/readme-blog/Python/Python/pycharm2018.html" class="prev">
          Pycharm2018.1.5 补丁破解
        </a></span> <!----></p></div> </div> <!----></div></div>
    <script src="/readme-blog/assets/js/11.71e3a724.js" defer></script><script src="/readme-blog/assets/js/4.590cfbfe.js" defer></script><script src="/readme-blog/assets/js/app.9f4188c2.js" defer></script>
  </body>
</html>
